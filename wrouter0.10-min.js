/*! wrouter v0.1.1 | (c) leiweicyz | www.51news.cc/license */
!function (a) { "use strict"; var b = function (b) { var d, e, f, c = this.configure(b); if (this.checkbrowser()) $(function () { $("body").delegate("a", "click", function () { return c.load($(this).attr("href")) ? !1 : void 0 }) }), c.load(), d = function () { c.load() }, this.html5history ? a.onpopstate = d : a.onhashchange = d; else { e = location.hash, e && e.indexOf("#") > -1 && (e = e.substr(e.indexOf("#") + 1, e.length - e.indexOf("#"))); for (f in c.routers) e.match(c.routers[f].rule) && (location.href = e) } }; b.prototype.combine = function () { var b, a = ""; for (b in arguments) a += b == arguments.length - 1 ? "/" + this.trim(arguments[b], 1) : "/" + this.trim(arguments[b]); return a }, b.prototype.trim = function (a, b, c) { return "number" == typeof b ? (c = b, b = "/") : !c && (c = 0), !b && (b = "/"), (0 == c || 1 == c) && 0 == a.indexOf(b) && (a = a.substr(1, a.length - 1)), (0 == c || 2 == c) && a.lastIndexOf(b) == a.length - b.length && (a = a.substr(0, a.length - b.length)), a }, b.prototype.checkbrowser = function () { var b, c; return "onpopstate" in a || "onhashchange" in a ? (b = navigator.userAgent, b.indexOf("compatible") > -1 && b.indexOf("MSIE") > -1 && -1 == b.indexOf("Opera") ? (c = new RegExp("MSIE (\\d+\\.\\d+);"), c.test(b), parseFloat(RegExp["$1"]) >= 8) : !0) : !1 }, b.prototype.configure = function (b) { var d, c = this; c.routers = b && b.routers || []; for (d in c.routers) "string" == typeof c.routers[d].rule && (c.routers[d].rule = new RegExp(c.routers[d].rule, "g")); return c.html5history = b && "boolean" == typeof b.html5history && !b.html5history ? b.html5history : void 0 !== a.history.pushState, c.root = b && b.root || "/", c.progress = b && b.progress || "#progress", c.onprogress = b && b.onprogress || function (a) { $(c.progress).css("width", 0).show().animate({ width: (0 == a.total ? 100 : 100 * (a.loaded / a.total)) + "%" }, function () { (0 == a.total || a.loaded == a.total) && $(c.progress).fadeOut(100) }) }, c }, b.prototype.getxhr = function () { return this.xhr ? this.xhr : (this.xhr = a.XMLHttpRequest ? new XMLHttpRequest : new ActiveXObject("Microsoft.XMLHTTP"), this.xhr.onprogress = this.onprogress, this.xhr) }, b.prototype.ajax = function (a, b) { var c = this, d = c.getxhr(); return d.open("GET", a), d.setRequestHeader("WRouter", "1.0"), d.send(null), d.onreadystatechange = function () { 4 == d.readyState && 200 == d.status && b && b(d.responseText), 4 == d.readyState && 200 != d.status && c.error && c.error(d.readyState) }, c }, b.prototype.load = function (b) { var e, c = this, d = b ? !0 : !1; if (b = b || (c.html5history ? location.pathname + location.search : location.hash), !c.html5history || b != c.root) { b.indexOf("#") > -1 && (b = c.html5history ? b.substr(0, b.indexOf("#")) : b.substr(b.indexOf("#") + 1, b.length - b.indexOf("#"))); for (e in c.routers) if (b.match(c.routers[e].rule)) return c.routers[e].title && (document.title = c.routers[e].title), c.ajax(b, function (a) { c.routers[e].container && $(c.routers[e].container).html(c.routers[e].action ? c.routers[e].action(a) : a), !c.routers[e].container && c.routers[e].action(a) }), d && (c.html5history ? a.history.pushState(null, null, b) : location.href = "#" + b), !0 } }, a.wrouter = b }(window);
